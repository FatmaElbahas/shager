<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/logout-notifications.css">
    <style>
        body {
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-button {
            margin: 10px;
            padding: 10px 20px;
        }
        .status {
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        .success { background-color: #d4edda; border-color: #c3e6cb; color: #155724; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; color: #721c24; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; color: #0c5460; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 class="text-center mb-4">ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</h1>
        
        <div class="row">
            <div class="col-md-6">
                <h3>Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h3>
                <button class="btn btn-primary test-button" onclick="setupTestData()">
                    Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©
                </button>
                <button class="btn btn-info test-button" onclick="checkCurrentData()">
                    ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                </button>
                <button class="btn btn-warning test-button" onclick="clearAllData()">
                    Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                </button>
            </div>
            
            <div class="col-md-6">
                <h3>Ø§Ø®ØªØ¨Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</h3>
                <!-- Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± -->
                <div class="d-flex align-items-center gap-2 mb-3">
                    <img src="images/Frame (3).png" alt="" class="icon" width="20">
                    <a href="#" id="logoutBtn" class="btn btn-danger">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a>
                </div>
                
                <button class="btn btn-success test-button" onclick="testLogoutFunction()">
                    Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØ¸ÙŠÙØ© ÙŠØ¯ÙˆÙŠØ§Ù‹
                </button>
                <button class="btn btn-secondary test-button" onclick="resetLogoutSystem()">
                    Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ø¸Ø§Ù…
                </button>
                
                <h4 class="mt-4">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ù†Ø³Ù‚</h4>
                <button class="btn btn-info test-button" onclick="testNotifications()">
                    Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
                </button>
                <button class="btn btn-warning test-button" onclick="testConfirmModal()">
                    Ø§Ø®ØªØ¨Ø§Ø± Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„ØªØ£ÙƒÙŠØ¯
                </button>
            </div>
        </div>
        
        <div class="mt-4">
            <h3>Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…</h3>
            <div id="statusContainer"></div>
        </div>
        
        <div class="mt-4">
            <h3>Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«</h3>
            <div id="logContainer" style="background: #000; color: #0f0; padding: 15px; border-radius: 5px; font-family: monospace; height: 200px; overflow-y: auto;"></div>
        </div>
    </div>

    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/logout.js"></script>
    
    <script>
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹Ø±ÙŠÙ console.log Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙÙŠ Ø§Ù„ØµÙØ­Ø©
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        function addToLog(message, type = 'log') {
            const logContainer = document.getElementById('logContainer');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#f00' : type === 'warn' ? '#ff0' : '#0f0';
            logContainer.innerHTML += `<div style="color: ${color}">[${timestamp}] ${message}</div>`;
            logContainer.scrollTop = logContainer.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToLog(args.join(' '), 'log');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToLog('ERROR: ' + args.join(' '), 'error');
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addToLog('WARN: ' + args.join(' '), 'warn');
        };
        
        // Ø¯ÙˆØ§Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
        function setupTestData() {
            const testData = {
                authToken: "test_token_123456789",
                user: JSON.stringify({
                    id: 1,
                    name: "Ù…Ø³ØªØ®Ø¯Ù… ØªØ¬Ø±ÙŠØ¨ÙŠ",
                    email: "test@example.com",
                    role: "user"
                }),
                hasTreeData: "true",
                userRole: "user"
            };
            
            Object.keys(testData).forEach(key => {
                localStorage.setItem(key, testData[key]);
            });
            
            updateStatus("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­", "success");
            checkCurrentData();
        }
        
        function checkCurrentData() {
            const statusContainer = document.getElementById('statusContainer');
            const keys = ['authToken', 'user', 'hasTreeData', 'userRole'];
            let html = '<h5>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙÙŠ localStorage:</h5>';
            
            keys.forEach(key => {
                const value = localStorage.getItem(key);
                const status = value ? 'Ù…ÙˆØ¬ÙˆØ¯' : 'ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯';
                const className = value ? 'success' : 'error';
                html += `<div class="status ${className}"><strong>${key}:</strong> ${status}</div>`;
            });
            
            statusContainer.innerHTML = html;
        }
        
        function clearAllData() {
            localStorage.clear();
            updateStatus("ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "info");
            checkCurrentData();
        }
        
        function testLogoutFunction() {
            if (typeof handleLogout === 'function') {
                updateStatus("ÙˆØ¸ÙŠÙØ© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…ÙˆØ¬ÙˆØ¯Ø© âœ“", "success");
                console.log("Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ¸ÙŠÙØ© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬...");
                
                // ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
                console.log("Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…:");
                console.log("- logoutInitialized:", window.logoutInitialized || false);
                console.log("- logoutSystemInitialized:", window.logoutSystemInitialized || false);
                console.log("- isLoggingOut:", window.isLoggingOut || false);
                
                // Ù…Ø­Ø§ÙƒØ§Ø© Ø­Ø¯Ø« Ø§Ù„Ù†Ù‚Ø±
                const fakeEvent = {
                    preventDefault: () => console.log("ØªÙ… Ù…Ù†Ø¹ Ø§Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ")
                };
                
                // ØªØ´ØºÙŠÙ„ Ø§Ù„ÙˆØ¸ÙŠÙØ©
                handleLogout(fakeEvent);
            } else {
                updateStatus("ÙˆØ¸ÙŠÙØ© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© âœ—", "error");
            }
        }
        
        function resetLogoutSystem() {
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±
            window.logoutInitialized = false;
            window.logoutSystemInitialized = false;
            window.isLoggingOut = false;
            
            // Ø¥Ø²Ø§Ù„Ø© Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ù…Ù† Ø§Ù„Ø²Ø±
            const logoutBtn = document.getElementById('logoutBtn');
            if (logoutBtn) {
                logoutBtn.removeAttribute('data-logout-initialized');
                logoutBtn.style.pointerEvents = '';
                logoutBtn.style.opacity = '';
                logoutBtn.textContent = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬';
            }
            
            console.log("ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø© Ù†Ø¸Ø§Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬");
            updateStatus("ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±", "info");
        }
        
        function updateStatus(message, type) {
            const statusContainer = document.getElementById('statusContainer');
            statusContainer.innerHTML = `<div class="status ${type}">${message}</div>`;
        }
        
        function testNotifications() {
            if (typeof showNotification === 'function') {
                console.log("Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª...");
                
                // Ø¥Ø´Ø¹Ø§Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
                showNotification("Ù…Ø¹Ù„ÙˆÙ…Ø§Øª", "Ù‡Ø°Ø§ Ø¥Ø´Ø¹Ø§Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠ", "info", 3000);
                
                setTimeout(() => {
                    // Ø¥Ø´Ø¹Ø§Ø± Ù†Ø¬Ø§Ø­
                    showNotification("Ù†Ø¬Ø­!", "ØªÙ… ØªÙ†ÙÙŠØ° Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­", "success", 3000);
                }, 1000);
                
                setTimeout(() => {
                    // Ø¥Ø´Ø¹Ø§Ø± ØªØ­Ø°ÙŠØ±
                    showNotification("ØªØ­Ø°ÙŠØ±", "Ø§Ù†ØªØ¨Ù‡ Ù„Ù‡Ø°Ø§ Ø§Ù„ØªØ­Ø°ÙŠØ±", "warning", 3000);
                }, 2000);
                
                setTimeout(() => {
                    // Ø¥Ø´Ø¹Ø§Ø± Ø®Ø·Ø£
                    showNotification("Ø®Ø·Ø£", "Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…", "error", 3000);
                }, 3000);
                
                updateStatus("ØªÙ… Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª âœ“", "success");
            } else {
                updateStatus("ÙˆØ¸ÙŠÙØ© showNotification ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© âœ—", "error");
            }
        }
        
        function testConfirmModal() {
            if (typeof showConfirmModal === 'function') {
                console.log("Ø§Ø®ØªØ¨Ø§Ø± Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„ØªØ£ÙƒÙŠØ¯...");
                
                showConfirmModal(
                    "Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…ÙˆØ¯Ø§Ù„",
                    "Ù‡Ø°Ø§ Ø§Ø®ØªØ¨Ø§Ø± Ù„Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„ØªØ£ÙƒÙŠØ¯. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŸ",
                    () => {
                        console.log("ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ ØªØ£ÙƒÙŠØ¯");
                        showNotification("ØªØ£ÙƒÙŠØ¯", "ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„ØªØ£ÙƒÙŠØ¯", "success", 2000);
                    },
                    () => {
                        console.log("ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø¥Ù„ØºØ§Ø¡");
                        showNotification("Ø¥Ù„ØºØ§Ø¡", "ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¥Ù„ØºØ§Ø¡", "info", 2000);
                    }
                );
                
                updateStatus("ØªÙ… ÙØªØ­ Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„ØªØ£ÙƒÙŠØ¯ âœ“", "success");
            } else {
                updateStatus("ÙˆØ¸ÙŠÙØ© showConfirmModal ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© âœ—", "error");
            }
        }
        
        // ØªØ´ØºÙŠÙ„ ÙØ­Øµ Ø£ÙˆÙ„ÙŠ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            console.log("ØªÙ… ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© Ø§Ø®ØªØ¨Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬");
            checkCurrentData();
            
            // ÙØ­Øµ ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¯ÙˆØ§Ù„
            setTimeout(() => {
                if (typeof initializeLogoutButton === 'function') {
                    console.log("âœ“ Ø¯Ø§Ù„Ø© initializeLogoutButton Ù…ÙˆØ¬ÙˆØ¯Ø©");
                } else {
                    console.error("âœ— Ø¯Ø§Ù„Ø© initializeLogoutButton ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©");
                }
                
                if (typeof handleLogout === 'function') {
                    console.log("âœ“ Ø¯Ø§Ù„Ø© handleLogout Ù…ÙˆØ¬ÙˆØ¯Ø©");
                } else {
                    console.error("âœ— Ø¯Ø§Ù„Ø© handleLogout ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©");
                }
                
                // ÙØ­Øµ Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
                const logoutBtn = document.getElementById('logoutBtn');
                if (logoutBtn) {
                    console.log("âœ“ Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„ØµÙØ­Ø©");
                } else {
                    console.error("âœ— Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯");
                }
            }, 1000);
        });
    </script>
</body>
</html>
